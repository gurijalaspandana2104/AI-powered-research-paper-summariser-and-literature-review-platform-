<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Your Research Companion</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>

<div class="container">

    <!-- Header -->
    <header class="header">
        <h1>ğŸ“š Your Research Companion</h1>
        <p>Upload a paper. Get clarity, structure, and insight.</p>
        <button id="themeToggle" class="theme-toggle">ğŸŒ™</button>
    </header>

    <!-- Upload Form -->
    <form method="POST" enctype="multipart/form-data" class="upload-card">

        <label for="pdfInput" class="file-drop">
            <span id="fileLabel">
                ğŸ“„ Drop your research paper here<br>
                <small>or click to browse</small>
            </span>
        </label>

        <input
            type="file"
            id="pdfInput"
            name="pdf"
            accept=".pdf"
            required
            style="display:none;"
        >

        <button type="submit" class="generate-btn">
            ğŸš€ Generate Review
        </button>

        <div class="spinner" id="progressText">
            ğŸ”„ Starting analysisâ€¦
        </div>
    </form>

    <!-- ğŸ”¹ PAPER STATS PANEL -->
    {% if summary %}
    <div class="result-card">
        <p>
            ğŸ“„ <strong>{{ page_count }}</strong> pages â€¢
            ğŸ“ <strong>{{ word_count }}</strong> words â€¢
            ğŸ§  AI summarized
        </p>
    </div>
    {% endif %}

    <!-- ğŸ”¹ MAIN RESULT -->
    {% if summary %}
    <section class="result-card">
        <h2>ğŸ§  AI-Generated Literature Review</h2>

        <!-- Literature Review Sections -->
        {% for section in summary.split("\n\n") %}
        <div class="section-card">
            <button class="section-header" onclick="toggleSection(this)">
                ğŸ“Œ {{ section.split("\n")[0] }}
            </button>
            <div class="section-body">
                {{ section }}
            </div>
        </div>
        {% endfor %}

        <!-- ğŸ‘©â€ğŸ”¬ CONTRIBUTORS SECTION -->
        
        

        <!-- ğŸ”¹ KEYWORD VISUALIZATION -->
        {% if keywords %}
        <div class="keyword-list">
            {% for k in keywords %}
            <span class="keyword">ğŸ”‘ {{ k }}</span>
            {% endfor %}
        </div>
        {% endif %}

        <a href="/download" class="download-btn">ğŸ“¥ Download PDF</a>
        <a href="/" class="reset-btn">ğŸ”„ Upload Another</a>
    </section>
    {% endif %}

    <!-- Footer -->
    <footer class="footer">
        <p>Built with â¤ï¸ to support researchers</p>
    </footer>

</div>
<!-- ğŸ’¬ CHATBOT SECTION --> 
  <!-- ğŸ’¬ CHATBOT -->
<div class="chat-widget">
    <div class="chat-header" onclick="toggleChat()">
        ğŸ’¬ Research Assistant
    </div>

    <div class="chat-body" id="chatBody">
        <div id="chatBox" class="chat-box"></div>

        <div class="chat-input-row">
            <input id="chatInput" placeholder="Ask: What is UAV?" />
            <button class="chat-send-btn" onclick="sendMessage()">Ask</button>
        </div>

        <button class="chat-clear-btn" onclick="clearChat()">ğŸ§¹ Clear chat</button>
    </div>
</div>


<script src="{{ url_for('static', filename='script.js') }}"></script>

<!-- File selection feedback -->
<script>
const fileInput = document.getElementById("pdfInput");
const fileLabel = document.getElementById("fileLabel");

if (fileInput) {
    fileInput.addEventListener("change", () => {
        if (fileInput.files.length > 0) {
            fileLabel.innerHTML = `
                âœ… <strong>${fileInput.files[0].name}</strong><br>
                <small>PDF selected successfully</small>
            `;
        }
    });
}
</script>

</body>
</html>
